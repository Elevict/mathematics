---
tags:
  - mathematics/ordinary_differential_equations
---
# Fundamental Matrices

The structure of the solutions of systems of linear differential equations can be further illuminated by introducing the idea of a fundamental matrix. Suppose that $x^{(1)}(t), \dots, x^{(n)}(t)$ form a fundamental set of solutions for the equation

$$
x' = P(t)x \tag{1}
$$

on some interval $\alpha < t < \beta$. Then the matrix

$$
\Phi(t) =
\begin{pmatrix}
x^{(1)}_1(t) & \cdots & x^{(n)}_1(t) \\
\vdots & \ddots & \vdots \\
x^{(1)}_n(t) & \cdots & x^{(n)}_n(t)
\end{pmatrix} \tag{2}
$$

whose columns are the vectors $x^{(1)}(t), \dots, x^{(n)}(t)$, is said to be a fundamental matrix for the system (1). Note that a fundamental matrix is nonsingular since its columns are linearly independent vectors.

> [!example] **Example 1**
> Find a fundamental matrix for the system
>
> $$
> x' =
> \begin{pmatrix}
> 1 & 1 \\
> 4 & 1
> \end{pmatrix} x \tag{3}
> $$
>
> Finding valid solutions in the normal way in the previous section, we find that
>
> $$
> x^{(1)}(t) =
> \begin{pmatrix}
> e^{3t} \\
> 2e^{3t}
> \end{pmatrix}, \quad x^{(2)}(t) =
> \begin{pmatrix}
> e^{-t} \\
> -2e^{-t}
> \end{pmatrix}
> $$
>
> are linearly independent solutions of Eq. (3). Thus a fundamental matrix for the system (3) is
>
> $$
> \Phi(t) =
> \begin{pmatrix}
> e^{3t} & e^{-t} \\
> 2e^{3t} & -2e^{-t}
> \end{pmatrix} \tag{4}
> $$

The solution of an initial value problem can be written very compactly in terms of a fundamental matrix. The general solution of Eq. (1) is

$$
x = c_1 x^{(1)}(t) + \dots + c_n x^{(n)}(t) \tag{5}
$$

or, in terms of $\Phi(t)$,

$$
x = \Phi(t)c, \tag{6}
$$

where $c$ is a constant vector with arbitrary components $c_1, \dots, c_n$. For an initial value problem consisting of the differential equation (1) and the initial condition

$$
x(t_0) = x_0, \tag{7}
$$

where $t_0$ is a given point in $\alpha < t < \beta$ and $x_0$ is a given initial vector, it is only necessary to choose the vector $c$ in Eq. (6) so as to satisfy the initial condition (7). Hence, $c$ must satisfy

$$
\Phi(t_0)c = x_0. \tag{8}
$$

Therefore, since $\Phi(t_0)$ is nonsingular,

$$
c = \Phi^{-1}(t_0) x_0 \tag{9}
$$

and

$$
x = \Phi(t)\Phi^{-1}(t_0) x_0 \tag{10}
$$

is the solution of the initial value problem (1), (7). We emphasize, however, that to solve a given initial value problem, we would ordinarily solve Eq. (8) by row reduction and then substitute for $c$ in Eq. (6), rather than compute $\Phi^{-1}(t_0)$ and use Eq. (10).

Recall that each column of the fundamental matrix $\Phi$ is a solution of Eq. (1). It follows that $\Phi$ satisfies the matrix differential equation

$$
\Phi' = P(t)\Phi. \tag{11}
$$

This relation is readily confirmed by comparing the two sides of Eq. (11) column by column.

Sometimes it is convenient to make use of the special fundamental matrix, denoted by $\Phi_0(t)$, whose columns are the vectors $x^{(1)}(t), \dots, x^{(n)}(t)$. Besides the differential equation (1), these vectors satisfy the initial conditions

$$
x^{(j)}(t_0) = e^{(j)}, \tag{12}
$$

where $e^{(j)}$ is the unit vector, with a one in the $j$th position and zeros elsewhere. Thus $\Phi_0(t)$ has the property that

$$
\Phi_0(t_0) =
\begin{pmatrix}
1 & 0 & \cdots & 0 \\
0 & 1 & \cdots & 0 \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \cdots & 1
\end{pmatrix} = I. \tag{13}
$$

We will always reserve the symbol $\Phi_0$ to denote the fundamental matrix satisfying the initial condition (13) and use $\Phi$ when an arbitrary fundamental matrix is intended. In terms of $\Phi_0(t)$, the solution of the initial value problem (1), (7) is even simpler in appearance; since $\Phi_0^{-1}(t_0) = I$, it follows from Eq. (10) that

$$
x = \Phi_0(t) x_0. \tag{14}
$$

Although the fundamental matrix $\Phi_0(t)$ is often more complicated than $\Phi(t)$, it is especially helpful if the same system of differential equations is to be solved repeatedly subject to many different initial conditions. This corresponds to a given physical system that can be started from many different initial states. If the fundamental matrix $\Phi_0(t)$ has been determined, then the solution for each set of initial conditions can be found simply by matrix multiplication, as indicated by Eq. (14). The matrix $\Phi_0(t)$ thus represents a transformation of the initial conditions $x_0$ into the solution $x(t)$ at an arbitrary time $t$. Comparing Eqs. (10) and (14) makes it clear that

$$
\Phi_0(t) = \Phi(t) \Phi^{-1}(t_0). \tag{15}
$$

> [!example] **Example** (Example 2)
> For the system (3) from Example 1, find the fundamental matrix $\Phi_0$ such that $\Phi_0(0) = I$. The columns of $\Phi_0$ are solutions of Eq. (3) that satisfy the initial conditions
>
> $$
> x^{(1)}(0) =
> \begin{pmatrix}
> 1 \\
> 0
> \end{pmatrix}, \quad x^{(2)}(0) =
> \begin{pmatrix}
> 0 \\
> 1
> \end{pmatrix}. \tag{15}
> $$
>
> Since the general solution of Eq. (3) is
>
> $$
> x = c_1
> \begin{pmatrix}
> 1 \\
> 2
> \end{pmatrix} e^{3t} + c_2
> \begin{pmatrix}
> 1 \\
> -2
> \end{pmatrix} e^{-t},
> $$
>
> we can find the solution satisfying the first set of these initial conditions by choosing $c_1 = c_2 = \frac{1}{2}$; similarly, we obtain the solution satisfying the second set of initial conditions by choosing $c_1 = \frac{1}{4}$ and $c_2 = -\frac{1}{4}$. Hence
>
> $$
> \Phi_0(t) =
> \begin{pmatrix}
> \frac{1}{2} e^{3t} + \frac{1}{2} e^{-t} & \frac{1}{4} e^{3t} - \frac{1}{4} e^{-t} \\
> e^{3t} - e^{-t} & \frac{1}{2} e^{3t} + \frac{1}{2} e^{-t}
> \end{pmatrix} \tag{16}
> $$
>
> Note that the elements of $\Phi_0(t)$ are more complicated than those of the fundamental matrix $\Phi(t)$ given by Eq. (4); however, it is now easy to determine the solution corresponding to any set of initial conditions.

## The Matrix $\exp(At)$

Recall that the solution of the scalar initial value problem

$$
x' = ax, \quad x(0) = x_0, \tag{17}
$$

where $a$ is a constant, is

$$
x = x_0 e^{at}. \tag{18}
$$

Now consider the corresponding initial value problem for an $n \times n$ system, namely,

$$
x' = Ax, \quad x(0) = x_0, \tag{19}
$$

where $A$ is a constant matrix. Applying the results of this section to the problem (19), we can write its solution as

$$
x = \Phi_0(t) x_0, \tag{20}
$$

where $\Phi_0(0) = I$. Comparing the problems (17) and (19), and their solutions, suggests that the matrix $\Phi_0(t)$ might have an exponential character. We now explore this possibility.

The scalar exponential function $e^{at}$ can be represented by the power series

$$
e^{at} = 1 + \sum_{n=1}^{\infty} \frac{a^n t^n}{n!}, \tag{21}
$$

which converges for all $t$. Let us now replace the scalar $a$ by the $n \times n$ constant matrix $A$ and consider the corresponding series

$$
I + \sum_{n=1}^{\infty} \frac{A^n t^n}{n!} = I + At + \frac{A^2 t^2}{2!} + \dots + \frac{A^n t^n}{n!} + \dots. \tag{22}
$$

Each term in the series (22) is an $n \times n$ matrix. It is possible to show that each element of this matrix sum converges for all $t$ as $n \to \infty$. Thus the series (22) defines as its sum a new matrix, which we denote by $\exp(At)$; that is,

$$
\exp(At) = I + \sum_{n=1}^{\infty} \frac{A^n t^n}{n!}. \tag{23}
$$

By differentiating the series (23) term by term, we obtain

$$
\frac{d}{dt} \left[\exp(At)\right] = \sum_{n=1}^{\infty} \frac{A^n t^{n-1}}{(n-1)!} = A \left[ I + \sum_{n=1}^{\infty} \frac{A^n t^n}{n!} \right] = A \exp(At). \tag{24}
$$

Therefore, $\exp(At)$ satisfies the differential equation

$$
\frac{d}{dt} \exp(At) = A \exp(At). \tag{25}
$$

Further, by setting $t = 0$ in Eq. (23), we find that $\exp(At)$ satisfies the initial condition

$$
\exp(At)\bigg|_{t=0} = I. \tag{26}
$$

The fundamental matrix $\Phi_0$ satisfies the matrix differential equation

$$
\Phi_0' = A \Phi_0, \tag{27}
$$

with the initial condition $\Phi_0(0) = I$, and the solution is given by the matrix exponential

$$
\Phi_0(t) = \exp(At). \tag{28}
$$

## Diagonalizing the Matrix $A$

If $A$ is diagonalizable, meaning it has a full set of linearly independent eigenvectors, it can be diagonalized using a similarity transformation. Specifically, if the eigenvalues of $A$ are $r_1, \dots, r_n$ with corresponding eigenvectors $\xi^{(1)}, \dots, \xi^{(n)}$, we can form the matrix $T$ whose columns are these eigenvectors. Then

$$
A = T D T^{-1}, \tag{32}
$$

where $D$ is the diagonal matrix with the eigenvalues of $A$. Using this, we can write the solution as

$$
\exp(At) = T \exp(Dt) T^{-1}, \tag{33}
$$

and this simplifies the problem significantly.

> [!example] **Example** (Example 3)
> Consider the matrix
>
> $$
> A =
> \begin{pmatrix}
> 1 & 1 \\
> 4 & 1
> \end{pmatrix}. \tag{33}
> $$
>
> The eigenvalues are $r_1 = 3$ and $r_2 = -1$, with eigenvectors
>
> $$
> \xi^{(1)} = \begin{pmatrix} 1 \\ 2 \end{pmatrix}, \quad \xi^{(2)} = \begin{pmatrix} 1 \\ -2 \end{pmatrix}. \tag{34}
> $$
>
> The transformation matrix $T$ is
>
> $$
> T =
> \begin{pmatrix}
> 1 & 1 \\
> 2 & -2
> \end{pmatrix}, \tag{35}
> $$
>
> and its inverse is
>
> $$
> T^{-1} =
> \begin{pmatrix}
> \frac{1}{2} & \frac{1}{4} \\
> \frac{1}{2} & -\frac{1}{4}
> \end{pmatrix}. \tag{35}
> $$
>
> Using this, we can compute
>
> $$
> T^{-1}AT = D
> $$

> [!example] **Example** (Example 4)
> Consider again the system of differential equations
>
> $$
> x' = Ax, \tag{45}
> $$
>
> where $A$ is given by Eq. (33). Using the transformation $x = Ty$, where $T$ is given by Eq. (35), you can reduce the system (45) to the diagonal system
>
> $$
> y' = \begin{pmatrix} 3 & 0 \\ 0 & -1 \end{pmatrix} y = Dy. \tag{46}
> $$
>
> Obtain a fundamental matrix for the system (46), and then transform it to obtain a fundamental matrix for the original system (45).
>
> By multiplying $D$ repeatedly with itself, we find that
>
> $$
> D^2 = \begin{pmatrix} 9 & 0 \\ 0 & 1 \end{pmatrix}, \quad D^3 = \begin{pmatrix} 27 & 0 \\ 0 & -1 \end{pmatrix}, \quad \dots \tag{47}
> $$
>
> Therefore, it follows from Eq. (23) that $\exp(Dt)$ is a diagonal matrix with the entries $e^{3t}$ and $e^{-t}$ on the diagonal; that is,
>
> $$
> \exp(Dt) = \begin{pmatrix} e^{3t} & 0 \\ 0 & e^{-t} \end{pmatrix}. \tag{48}
> $$
>
> Finally, we obtain the required fundamental matrix $\Phi(t)$ by multiplying $T$ and $\exp(Dt)$:
>
> $$
> \Phi(t) = \begin{pmatrix} 1 & 1 \\ 2 & -2 \end{pmatrix} \begin{pmatrix} e^{3t} & 0 \\ 0 & e^{-t} \end{pmatrix} = \begin{pmatrix} e^{3t} & e^{-t} \\ 2e^{3t} & -2e^{-t} \end{pmatrix}. \tag{49}
> $$
>
> Observe that this fundamental matrix is the same as the one found in Example 1.
