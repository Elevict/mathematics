---
tags:
  - mathematics/ordinary_differential_equations
---
# Nonhomogeneous Linear Systems

> [!example] **Example** (Nonhomogeneous System)
> Solve the following nonhomogeneous linear system,
>
> $$
> X' = \begin{pmatrix}
> -3 & 1 \\
> 2 & 4
> \end{pmatrix}X +
> \begin{pmatrix}
> 3t \\
> e^{-t}
> \end{pmatrix}
> $$

## Solve for Eigenvectors and Eigenvalues

First assume that

$$
X' = \begin{pmatrix}
-3 & 1 \\
2 & 4
\end{pmatrix}X
$$

Then, we find the characteristic equation

$$
\begin{align}
\begin{vmatrix}
-3-\lambda & 1 \\
2 & -4-\lambda
\end{vmatrix} &= (-3-\lambda)(-4-\lambda)-2 \\
&= 12 + 7\lambda \lambda^{2} - 2 \\
&= \lambda^{2} + 7\lambda + 10 \\
&= (\lambda+2)(\lambda+5) = 0 \\
 & \lambda_{1} = -2, \quad \lambda_{2} = -5
\end{align}
$$

Now the eigenvector for $\lambda_{1} = -2$,

$$
\begin{align}
 & \left(\begin{array}{cc|c}  
-1 & 1 & 0 \\
2 & -2 & 0
\end{array}\right) \\
 & \left(\begin{array}{cc|c}  
1 & -1 & 0 \\
0 & 0 & 0
\end{array}\right) \\
& k_{1} - k_{2} = 0 \\
& k_{1} = k_{2}
\end{align}
$$

Let $k_{1} = 1$, then

$$
K_{1} = \begin{pmatrix}
k_{1} \\
k_{2}
\end{pmatrix} =
\begin{pmatrix}
1 \\
1
\end{pmatrix}
$$

Now the eigenvector for $\lambda_{2} = -5$,

$$
\begin{align}
 & \left(\begin{array}{cc|c}  
2 & 1 & 0 \\
2 & 1 & 0
\end{array}\right) \\
 & \left(\begin{array}{cc|c}  
1 & \frac{1}{2} & 0 \\
0 & 0 & 0
\end{array}\right) \\
& k_{1} + \frac{1}{2}k_{2} = 0 \\
& k_{1} = -\frac{1}{2} k_{2}
\end{align}
$$

Let $k_{2} = -2$, then

$$
K_{2} = \begin{pmatrix}
1 \\
-2
\end{pmatrix}
$$

So then our homogeneous solution is

$$
x_{c} = a_{1}\begin{pmatrix}
1 \\
1
\end{pmatrix}
e^{-2t} + c_{2} \begin{pmatrix}
1 \\
-2
\end{pmatrix} e^{-5t}
$$

## Solve for Fundamental Matrices and Integrate

Then our fundamental matrix is

$$
\Phi(t) = \begin{pmatrix}
e^{-2t} & e^{-5t} \\
e^{-2t} & -2e^{-5t}
\end{pmatrix}
$$

and the formula we are solving for is,

$$
X = \Phi(t)\vec{C} = \Phi(t) \int \Phi ^{-1}(t) F(t) \ dt
$$

$$
\begin{align}
\Phi ^{-1}(t) &= \frac{1}{\det \Phi(t)} \begin{pmatrix}
-2e^{-5t} & -e^{-5t} \\
-e^{-2t} & e^{-2t}
\end{pmatrix} \\
&= -\frac{1}{3} e^{7t} \begin{pmatrix}
-2e^{-5t} & -e^{-5t} \\
-e^{-2t} & e^{-2t}
\end{pmatrix} \\
&= \begin{pmatrix}
\frac{2}{3} e^{2t} & \frac{1}{3}e^{2t} \\
\frac{1}{3}e^{5t} & -\frac{1}{3}e^{5t}
\end{pmatrix} \\
\Phi ^{-1}(t)F(t) &= \begin{pmatrix}
\frac{2}{3}e^{2t} & \frac{1}{3}e^{2t} \\
\frac{1}{3}e^{5t} & -\frac{1}{3}e^{5t}
\end{pmatrix}
\begin{pmatrix}
3t \\
e^{-t}
\end{pmatrix} \\
&= \begin{pmatrix}
2te^{2t} + \frac{1}{3}e^{t} \\
te^{5t} - \frac{1}{3}e^{4t}
\end{pmatrix} \\
 \int \Phi ^{-1}(t)F(t) \ dt &= \int \begin{pmatrix}
2te^{2t} + \frac{1}{3}e^{t} \\
te^{5t} - \frac{1}{3}e^{4t}
\end{pmatrix} \ dt \\
&=\begin{pmatrix}
te^{2t} - \frac{1}{2}e^{2t} + \frac{1}{3}e^{t} \\
\frac{1}{5}te^{5t} - \frac{1}{25}e^{5t} - \frac{1}{12}e^{4t}
\end{pmatrix}
\end{align}
$$

Now we put it all together,

$$
\begin{align}
\Phi(t) \int \Phi ^{-1}(t) F(t) \ dt &= \begin{pmatrix}
e^{-2t} & e^{-5t} \\
e^{-2t} & -2e^{-5t}
\end{pmatrix} \begin{pmatrix}
te^{2t} - \frac{1}{2}e^{2t} + \frac{1}{3}e^{t} \\
\frac{1}{5}te^{5t} - \frac{1}{25}e^{5t} - \frac{1}{12}e^{4t}
\end{pmatrix} \\
&= \begin{pmatrix}
t - \frac{1}{2} + \frac{1}{3}e^{-t} + \frac{1}{5}t - \frac{1}{25} - \frac{1}{12} e^{-t} \\
t - \frac{1}{2} + \frac{1}{3}e^{-t} -\frac{2}{5}t + \frac{2}{25} + \frac{1}{6}e^{-t}
\end{pmatrix} \\
&= \begin{pmatrix}
\frac{6}{5}t - \frac{27}{50} + \frac{1}{4}e^{-t} \\
\frac{3}{5}t - \frac{21}{50} + \frac{1}{2}e^{-t}
\end{pmatrix} \\
X(t) &= \begin{pmatrix}
e^{-2t} & e^{-5t} \\
e^{-2t} & -2e^{-5t}
\end{pmatrix} \begin{pmatrix}
C_{1} \\
C_{2}
\end{pmatrix} +
\begin{pmatrix}
\frac{6}{5}t - \frac{27}{50} + \frac{1}{4}e^{-t} \\
\frac{3}{5}t - \frac{21}{50} + \frac{1}{2}e^{-t}
\end{pmatrix} \\
X(t) &= C_{1}\begin{pmatrix}
1 \\
1
\end{pmatrix} e^{-2t}
+ C_{2} \begin{pmatrix}
1 \\
-2
\end{pmatrix}e^{-5t} + \begin{pmatrix}
\frac{6}{5} \\
\frac{3}{5}
\end{pmatrix}t
+ \begin{pmatrix}
\frac{1}{4} \\
\frac{1}{2}
\end{pmatrix} e^{-t} + \begin{pmatrix}
-\frac{27}{50} \\
-\frac{21}{50}
\end{pmatrix}
\end{align}
$$