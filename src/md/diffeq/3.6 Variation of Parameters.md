---
tags:
  - mathematics/ordinary_differential_equations
---
# Variation of Parameters

Let us consider an arbitrary equation,

$$
y'' + p(t)y' + q(t)y = g(t),
$$

where $p, q,$ and $g$ are given continuous functions. Now let us assume we know the general solution

$$
y_{c}(t) = c_{1}y_{1}(t) + c_{2}y_{2}
(t)
$$

of the corresponding homogeneous equation

$$
y'' + p(t)y' + q(t)y = 0
$$

Now lets replace our constants $c_{1}$ and $c_{2}$ with functions $u_{1}(t)$ and $u_{2}(t)$, thus we have

$$
y_{c}(t) = u_{1}(t)y_{1}(t) + u_{2}(t)y_{2}(t)
$$

Then we try to determine $u_{1}(t)$ and $u_{2}(t)$ so that the expression is a solution of the nonhomogeneous equation rather than the homogeneous equation. So lets differentiate.

$$
y' = u_{1}'(t)y_{1}(t) + u_{1}(t)y_{1}'(t) + u_{2}'(t)y_{2}(t) + u_{2}(t)y_{2}'(t)
$$

and now since we can choose arbitrary forcing functions, lets let $u_{1}'(t)$ and $u_{2}'(t)$ equal to 0 so that

$$
u_{1}'(t) y_{1}(t) + u_{2}'(t) y_{2}(t) = 0
$$

Then, we get

$$
y' = u_{1}(t)y_{1}'(t) + u_{2}(t )y_{2}'(t)
$$

Further, by differentiating again, we obtain

$$
y'' = u_{1}'(t)y_{1}'(t) + u_{1}(t)y_{1}''(t) + u_{2}'(t)y_{2}'(t) + u_{2}(t)y_{2}''(t)
$$

Now substitute for $y, y',$ and $y''$ and rearrange the terms to get.

$$
u_{1}(t)[y_{1}''(t) + p(t)y_{1}' + q(t)y_{1}(t)] + u_{2}(t)[y_{2}''(t) + p(t)y_{2}'(t) + q(t)y_{2}(t)] + u_{1}'(t)y_{1}'(t) + u_{2}'(t)y_{2}'(t) = g(t)
$$

Each of the expressions in square brackets end up being zero since $y_{1}$ and $y_{2}$ are solutions of the homogeneous equation. So our expression reduces into,

$$
u_{1}'(t)y_{1}'(t) + u_{2}'(t)y_{2}'(t) = g(t)
$$

And this ultimately gives us a system of equations. That system of equations when solved gives us the forcing functions, which are

$$
u_{1}'(t) = - \frac{y_{2}(t)g(t)}{W(y_{1}, y_{2})(t)} \quad u_{2}'(t) = - \frac{y_{1}(t)g(t)}{W(y_{1}, y_{2})(t)}
$$

where $W(y_{1}, y_{2})$ is the Wronskian of $y_{1}$ and $y_{2}$. Integrating both sides gives us the desired theorem below.

> [!theorem] **Theorem** (Variation of Parameters)
> If the functions $p, q$ and $g$ are continuous on an open interval $I$, and if the functions $y_{1}$ and $y_{2}$ are a fundamental set of solutions of the homogeneous equation corresponding to the nonhomogeneous equation
>
> $$
> y'' + p(t)y' + q(t)y = g(t)
> 
> $$
>
> then a particular solution is
>
> $$
> Y(t) = -y_{1}(t) \int_{t_{0}}^{t} \frac{y_{2}(s)g(s)}{W(y_{1}, y_{2})} \ ds + y_{2}(t) \int_{t_{0}}^{t} \frac{y_{1}(s)g(s)}{W(y_{1}, y_{2})(s)} \ ds
> $$
>
> where $t_{0}$ is any conveniently chosen point in $I$. The general solution is
>
> $$
> y = c_{1}y_{1}(t) + c_{2}y_{2}(t) + Y(t)
> $$

> [!example] **Example** (Variation of Parameters)
> Solve the following differential equation,
>
> $$
>  y'' + y = \sec(x), \quad y(0) = 0, \quad y'(0) = 0 
> $$
>
> The homogeneous characteristic equation is,
>
> $$
>  y_h = C_1\cos(x) + C_2\sin(x) 
> $$
>
> The formula for the particular solution is given as,
>
> $$
> y_p(x) = -y_1(x) \int \frac{y_2(s)\sec(s)}{W} \, ds + y_2(x) \int \frac{y_1(s)\sec(s)}{W} \, ds,
> $$
>
> where $y_1(x) = \cos(x)$, $y_2(x) = \sin(x)$, and $W = 1$.
>
> $$
> \begin{align}
> y_p(x) &= -\cos(x) \int \sin(s)\sec(s) \, ds + \sin(x) \int \cos(s)\sec(s) \, ds \\
> y_p(x) &= -\cos(x) \int \tan(s) \, ds + \sin(x) \int 1 \, ds \\
> y_p(x) &= -\cos(x)(\ln|\sec(s)|) + \sin(x)s \\
> y_p(x) &= -\ln|\sec(x)|\cos(x) + x\sin(x)
> \end{align}
> $$
>
> And so our general solution would ultimately be,
>
> $$
> y(x) = y_h + y_p = C_1\cos(x) + C_2\sin(x) - \ln|\sec(x)|\cos(x) + x\sin(x)
> $$
>
> And finally applying out initial conditions, we get
>
> $$
> \begin{align}
> y(0) = 0 \quad \implies \quad C_1 = 0 \\
> y'(0) = 0 \quad \implies \quad C_2 = 0
> \end{align}
> $$
>
> $$
> y(x) = -\ln|\sec(x)|\cos(x) + x\sin(x)
> $$
